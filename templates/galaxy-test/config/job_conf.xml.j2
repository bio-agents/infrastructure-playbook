<?xml version="1.0"?>
<!--
%
% This file is managed by Ansible.
% Do not edit this file manually.
% Any changes will be automatically reverted.
%
-->
<job_conf>
	<plugins workers="{{ galaxy_jobconf.plugin_workers }}">
{% for plugin in galaxy_jobconf['plugins'] %}
		<plugin id="{{ plugin['id'] }}" type="runner" {% if 'load' in plugin %}load="{{ plugin['load'] }}"{% endif %}>
{% if 'params' in plugin %}
{% for k in plugin['params']|dict2items|sort(attribute='key')|list|items2dict %}
			<param id="{{ k }}">{{ plugin['params'][k] }}</param>
{% endfor %}
{% endif %}
		</plugin>
{% endfor %}
	</plugins>
	<handlers{% if galaxy_jobconf.handlers.assign_with is defined %} assign_with="{{ galaxy_jobconf.handlers.assign_with }}"{% endif %}{% if galaxy_jobconf.handlers.default is defined %} default="{{ galaxy_jobconf.handlers.default }}"{% endif %}{% if galaxy_jobconf.handlers.max_grab is defined %} max_grab="{{ galaxy_jobconf.handlers.max_grab }}"{% endif %}>
{% for n in range(galaxy_handler_count) %}
		<handler id="handler_{{ galaxy_instance_codename }}_{{ n }}"/>
{% endfor %}
	</handlers>
	<destinations default="{{ galaxy_jobconf['default_destination'] }}">
{% for destination in galaxy_jobconf['destinations'] %}
		<destination id="{{ destination['id'] }}" runner="{{ destination['runner'] }}">
{% if 'env' in destination %}
{% for k in destination['env']|dict2items|sort(attribute='key')|list|items2dict %}
			<env id="{{ k }}">{{ destination['env'][k] }}</env>
{% endfor %}
{% endif %}
{% if 'params' in destination %}
{% for k in destination['params']|dict2items|sort(attribute='key')|list|items2dict %}
			<param id="{{ k }}">{{ destination['params'][k] }}</param>
{% endfor %}
{% endif %}
{% if 'raw' in destination %}
			{{ destination['raw'] }}
{% endif %}
		</destination>
{% endfor %}
	</destinations>
	<agents>
{% for agent in galaxy_jobconf['agents'] %}
		<agent id="{{ agent['id'] }}" destination="{{ agent['destination'] }}" />
{% endfor %}
		<!-- Per handler echos-->
{% for n in range(galaxy_handler_count) %}
		<agent id="echo_main_handler{{ n }}" destination="local" handler="handler{{ n }}"/>
{% endfor %}
	</agents>
	<limits>
{% for limit in galaxy_jobconf['limits'] | sort(attribute='type') %}
{% if 'id' in limit %}
		<limit type="{{ limit['type'] }}" id="{{ limit['id'] }}">{{ limit['value'] }}</limit>
{% elif 'tag' in limit %}
		<limit type="{{ limit['type'] }}" tag="{{ limit['tag'] }}">{{ limit['value'] }}</limit>
{% elif 'window' in limit %}
		<limit type="{{ limit['type'] }}" window="{{ limit['window'] }}">{{ limit['value'] }}</limit>
{% else %}
		<limit type="{{ limit['type'] }}">{{ limit['value'] }}</limit>
{% endif %}
{% endfor %}
	</limits>
</job_conf>
